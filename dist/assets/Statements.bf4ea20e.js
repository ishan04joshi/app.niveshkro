var X=Object.defineProperty,Z=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var P=(n,l,p)=>l in n?X(n,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):n[l]=p,R=(n,l)=>{for(var p in l||(l={}))q.call(l,p)&&P(n,p,l[p]);if(N)for(var p of N(l))ee.call(l,p)&&P(n,p,l[p]);return n},E=(n,l)=>Z(n,$(l));import{m as Y,S as u,B as L,u as te,f as oe,g as se,r as m,h as ie,b as ae,j as r,d as t,H as M,e as x,M as re,D as ne,F as ce,G as le,J as de,T as f,v as ue,K as he,N as pe,I as _,O as ge,i as me,E as Se,A as fe,k as ye,l as Ce,n as we,o as be,Q as xe,p as ve,q as Me,P as ze,a6 as Ae,y as Re,z as Ee,a7 as Le}from"./index.996e1d78.js";import{A as Te}from"./chakra-ui-icons.esm.135d50ad.js";import{S as F}from"./chakra-ui-select.esm.de14ec1a.js";const je=Y(u),W=Y(L),Ie={hidden:{scale:0},animate:{scale:1,transition:{staggerChildren:.5,delayChildren:.4}}},ke={hidden:{opacity:0},animate:{opacity:1}},Oe=()=>{var I;const n=te(),l=oe();se();const[p,O]=m.exports.useState(1),[z,H]=m.exports.useState(10),{isOpen:V,onOpen:T,onClose:j}=ie(),{user:h}=ae(),[A,Be]=m.exports.useState([]),[C,G]=m.exports.useState([]),[De,J]=m.exports.useState(null);m.exports.useState(0);const[Ne,S]=m.exports.useState(!1),[g,w]=m.exports.useState([]),v=async()=>{var e,s;try{const{data:i}=await Ae(p,z);return i.error?n({title:"Error",description:i.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"}):(G(i==null?void 0:i.data),n({title:"Success",description:i.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(i){console.error(i),n({title:"Error",description:((s=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:s.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},Q=async e=>{var s,i;try{S(!0);const{data:o}=await Re({id:e});if(S(!1),o.error)return n({title:"Error",description:o.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});v(),n({title:"Success",description:o.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(o){S(!1),console.error(o),n({title:"Error",description:((i=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},K=async e=>{var s,i;try{S(!0);const{data:o}=await Ee({id:e});if(S(!1),o.error)return n({title:"Error",description:o.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});v(),n({title:"Success",description:o.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(o){S(!1),console.error(o),n({title:"Error",description:((i=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},U=async()=>{var s,i;if(!g||(g==null?void 0:g.length)===0)return n({title:"Error",description:"Invalid details entered!",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});let e=!1;if(g.forEach(o=>{const{fund:y,dateType:a,date:c}=o;if(!y||!a||a==="custom"&&(!c||!c.from||!c.to))return e=!0}),e)return n({title:"Error",description:"Invalid details entered!",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});S(!0);try{const{data:o}=await Le({requested:g});if(S(!1),o.error)return n({title:"Error",description:o.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"});v(),j(),n({title:"Success",description:o.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(o){S(!1),console.error(o),n({title:"Error",description:((i=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}};return m.exports.useEffect(()=>{v()},[p,z]),m.exports.useEffect(()=>{var e,s;!((e=l==null?void 0:l.state)!=null&&e.fund)||(J((s=l==null?void 0:l.state)==null?void 0:s.fund),T())},[(I=l==null?void 0:l.state)==null?void 0:I.fund]),r(L,{sx:{minHeight:"90vh",display:"flex",flexDirection:"column",pb:4,py:4,px:2},children:[r(u,{direction:"row",justifyContent:"space-between",children:[t(M,{color:"gray.600",children:"Request Statements"}),!(h!=null&&h.isAdmin)&&t(x,{colorScheme:"blue",onClick:T,children:"Request New Statement"})]}),r(re,{onClose:j,isOpen:V,isCentered:!0,scrollBehavior:"inside",size:ne({base:"sm",sm:"md",md:"md",lg:"3xl",xl:"3xl"}),sx:{mx:2},children:[t(ce,{}),r(le,{children:[t(de,{children:r(u,{direction:"row",spacing:3,children:[t(f,{alignSelf:"center",children:"Request New Account Statement "}),t(ue,{icon:t(Te,{}),"aria-label":"new-request",variant:"outline",onClick:()=>{w(e=>[...e,{fund:null,dateType:"Last 1 Month"}])}})]})}),t(he,{}),t(pe,{children:t(u,{spacing:3,children:g.map((e,s)=>{var i,o,y;return r(u,{direction:"column",spacing:3,children:[t(F,{placeholder:"Select Fund",onChange:a=>{const c=[...g];c[s].fund=a.target.value,w(c)},children:(i=h==null?void 0:h.funds)==null?void 0:i.map(a=>{var c,b,d;return t("option",{value:(c=a==null?void 0:a.id)==null?void 0:c._id,children:(b=a==null?void 0:a.id)==null?void 0:b.name},(d=a==null?void 0:a.id)==null?void 0:d._id)})}),r(u,{direction:"row",spacing:3,justifyContent:"space-around",children:[r(u,{direction:"column",spacing:1,children:[t(f,{children:"Range:"}),r(F,{placeholder:"Select Date Range",onChange:a=>{const c=[...g];c[s].dateType=a.target.value,w(c)},children:[t("option",{value:"Last 1 Month",children:"Last 1 Month"}),t("option",{value:"Last 3 Months",children:"Last 3 Months"}),t("option",{value:"Last 6 Months",children:"Last 6 Months"}),t("option",{value:"Last 1 Year",children:"Last 1 Year"}),t("option",{value:"custom",children:"Custom"})]})]}),e.dateType==="custom"&&r(u,{direction:"row",spacing:1,alignSelf:"center",children:[r(u,{spacing:0,children:[t(f,{children:"From:"}),t(_,{type:"date",value:(o=e==null?void 0:e.date)==null?void 0:o.from,onChange:a=>{const c=[...g];c[s].date=E(R({},c[s].date),{from:a.target.value}),w(c)}})]}),r(u,{spacing:0,children:[t(f,{children:"To:"}),t(_,{type:"date",value:(y=e==null?void 0:e.date)==null?void 0:y.to,onChange:a=>{const c=[...g];c[s].date=E(R({},c[s].date),{to:a.target.value}),w(c)}})]})]})]}),t(u,{direction:"row",spacing:3,alignSelf:"end",children:t(x,{colorScheme:"red",onClick:()=>{const a=[...g];a.splice(s,1),w(a)},children:"Discard"})})]},s*2)})})}),t(ge,{children:t(x,{colorScheme:"blue",onClick:U,children:"Submit"})})]})]}),r(je,{variants:Ie,initial:"hidden",animate:"animate",direction:"column",spacing:2,sx:{px:{sm:2,lg:6},pt:4},children:[(C==null?void 0:C.length)===0&&r(u,{direction:"column",spacing:3,justifyContent:"center",alignItems:"center",h:"80vh",children:[t(me,{animationData:Se,autoPlay:!0,loop:!0,style:{height:"60vh",width:"60vw"}}),t(M,{children:"No Statements Requested!"})]}),t(fe,{defaultIndex:[0],children:t(u,{spacing:3,children:C==null?void 0:C.map((e,s)=>{var i,o,y,a,c,b;return r(ye,{children:[t(W,{variants:ke,px:8,py:4,rounded:"lg",shadow:"lg",bg:Ce("white","gray.800"),maxW:"100%",children:t(we,{_focus:{border:"0px"},children:t(u,{direction:"row",spacing:2,justifyContent:"space-evenly",children:t(u,{ml:2,w:"100%",direction:"row",spacing:4,alignItems:"center",justifyContent:"space-between",children:r(u,{direction:"row",spacing:2,divider:t(be,{}),children:[r(u,{spacing:1,children:[r(M,{size:"md",alignSelf:"center",color:"gray.600",children:[(i=e==null?void 0:e.user)==null?void 0:i.firstName," ",(o=e==null?void 0:e.user)==null?void 0:o.lastName]}),r(f,{size:"sm",alignSelf:"center",color:"gray.600",noOfLines:2,children:["PAN: ",(a=(y=e==null?void 0:e.user)==null?void 0:y.pan)==null?void 0:a.id]})]}),r(f,{color:"gray.600",size:"md",alignSelf:"center",children:["Created At:"," ",xe(e==null?void 0:e.createdAt).format("DD-MM-YYYY")]}),r(f,{color:"gray.500",size:"md",alignSelf:"center",children:["Requested For: ",(c=e==null?void 0:e.requested)==null?void 0:c.length," Statements"]}),t(ve,{size:"lg",colorScheme:"gray",children:e==null?void 0:e.status})]})})})})},e._id),t(Me,{pb:4,border:"1px",rounded:"lg",borderTop:"0px",borderColor:"gray.400",children:r(W,{px:2,py:2,children:[t(u,{direction:"column",spacing:3,children:(b=e==null?void 0:e.requested)==null?void 0:b.map((d,Pe)=>{var k,B,D;return r(u,{direction:"row",spacing:3,children:[t(M,{color:"gray.600",fontSize:"sm",children:(k=d==null?void 0:d.fund)==null?void 0:k.name}),r(f,{color:"gray.400",fontSize:"xs",children:["Range: ",d==null?void 0:d.dateType]}),(d==null?void 0:d.dateType)==="custom"&&r(f,{color:"gray.600",fontSize:"sm",children:[(B=d==null?void 0:d.date)==null?void 0:B.from," ","<==>"," ",(D=d==null?void 0:d.date)==null?void 0:D.to]})]},d==null?void 0:d._id)})}),r(u,{direction:"row",spacing:1,pt:4,children:[(e==null?void 0:e.status)==="pending"&&(h==null?void 0:h.isAdmin)&&t(x,{alignSelf:"center",onClick:()=>Q(e==null?void 0:e._id),colorScheme:"green",size:"sm",variant:"solid",children:"Complete"}),(e==null?void 0:e.status)==="pending"&&(h==null?void 0:h.isAdmin)&&t(u,{direction:"row",spacing:1,children:(h==null?void 0:h.isAdmin)&&t(x,{onClick:()=>K(e==null?void 0:e._id),colorScheme:"red",size:"sm",variant:"solid",children:"Reject"})})]})]})})]})})})})]}),t(L,{sx:{},children:(A==null?void 0:A.length)>0&&t(ze,{defaultPageSize:z,defaultPage:p,total:500,paginationProps:{display:"flex",justifyContent:"center",marginTop:"2em"},pageNeighbours:1,showQuickJumper:!0,responsive:!0,onChange:e=>O(e),onShowSizeChange:(e,s)=>H(parseInt(s)),showSizeChanger:!0})})]})};export{Oe as default};
