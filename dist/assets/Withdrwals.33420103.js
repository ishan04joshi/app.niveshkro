import{m as I,S as l,B as z,u as G,f as J,g as Q,r as u,h as K,b as X,j as o,d as r,H as b,e as h,M as Z,D as $,F as ee,G as te,J as se,K as re,N as ie,T as f,I as T,O as oe,i as ae,E as ne,l as le,o as ce,p as w,t as de,Q as ue,P as he,R as pe,U as ge,V as me,W as be,X as we}from"./index.996e1d78.js";import{S as Ce}from"./chakra-ui-select.esm.de14ec1a.js";const Se=I(l),ye=I(z),xe={hidden:{scale:0},animate:{scale:1,transition:{staggerChildren:.5,delayChildren:.4}}},ve={hidden:{opacity:0},animate:{opacity:1}},We=()=>{var N,M;const a=G(),c=J();Q();const[C,P]=u.exports.useState(1),[S,B]=u.exports.useState(10),{isOpen:F,onOpen:W,onClose:y}=K(),{user:n}=X(),[d,R]=u.exports.useState([]),[x,E]=u.exports.useState(null),[g,L]=u.exports.useState(0),[m,v]=u.exports.useState(!1),[A,U]=u.exports.useState(""),p=async()=>{var e,i;try{const{data:t}=await pe(C,S);return t.error?a({title:"Error",description:t.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"}):(R(t==null?void 0:t.data),a({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),a({title:"Error",description:((i=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},_=async e=>{var i,t;try{const{data:s}=await ge({id:e});return s.error?a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"}):(p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},V=async e=>{var i,t;try{if(!A)return a({title:"Error",description:"Please enter UTR",status:"error",duration:3e3,isClosable:!0});const{data:s}=await me({id:e,utr:A});if(s.error)return a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},H=async e=>{var i,t;try{const{data:s}=await be({id:e});if(s.error)return a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},O=async()=>{var e,i;if(!x||isNaN(g)||g<=0)return a({title:"Error",description:"Invalid details entered!",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});v(!0);try{const{data:t}=await we({fund:x,amount:g});if(v(!1),t.error)return a({title:"Error",description:t.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"});p(),y(),Y(),a({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(t){v(!1),console.error(t),a({title:"Error",description:((i=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},Y=()=>{setNewsTitle(""),setNewsDescription(""),setNewsImage(null),setNewsCategory("")};return u.exports.useEffect(()=>{p()},[C,S]),u.exports.useEffect(()=>{var e,i;!((e=c==null?void 0:c.state)!=null&&e.fund)||(E((i=c==null?void 0:c.state)==null?void 0:i.fund),W())},[(N=c==null?void 0:c.state)==null?void 0:N.fund]),o(z,{sx:{minHeight:"90vh",display:"flex",flexDirection:"column",pb:4,px:2,py:4},children:[o(l,{direction:"row",justifyContent:"space-between",children:[r(b,{color:"gray.600",children:"Withdrawals"}),!(n!=null&&n.isAdmin)&&r(h,{colorScheme:"blue",onClick:W,children:"Request New Statement"})]}),o(Z,{onClose:y,isOpen:F,isCentered:!0,scrollBehavior:"inside",size:$({base:"sm",sm:"md",md:"md",lg:"lg",xl:"xl"}),sx:{mx:2},children:[r(ee,{}),o(te,{children:[r(se,{children:"Add Withdrawal"}),r(re,{}),r(ie,{children:o(l,{spacing:{base:6,md:10},children:[o(l,{spacing:1,children:[r(f,{color:"gray.700",children:"Available Funds:"}),r(Ce,{value:x,onChange:e=>E(e.target.value),placeholder:"Select a fund",children:(M=n==null?void 0:n.funds)==null?void 0:M.map(e=>{var i,t,s;return r("option",{value:(i=e==null?void 0:e.id)==null?void 0:i._id,children:(t=e==null?void 0:e.id)==null?void 0:t.name},(s=e==null?void 0:e.id)==null?void 0:s._id)})})]}),o(l,{spacing:1,children:[r(f,{color:"gray.700",children:"Amount to Withdraw:"}),r(T,{value:g,placeholder:"Enter Amount",required:!0,type:"number",min:0,size:"md",onChange:e=>L(+e.target.value)})]}),o(l,{direction:"row",spacing:2,children:[r(h,{variant:"solid",bg:"#0D74FF",color:"white",onClick:O,isDisabled:m,isLoading:m,children:"Withdraw"}),r(h,{onClick:y,isDisabled:m,isLoading:m,children:"Close"})]})]})}),r(oe,{})]})]}),o(Se,{variants:xe,initial:"hidden",animate:"animate",direction:"column",spacing:2,sx:{px:{sm:2,lg:6},pt:4},children:[(d==null?void 0:d.length)===0&&o(l,{direction:"column",spacing:3,justifyContent:"center",alignItems:"center",h:"80vh",children:[r(ae,{animationData:ne,autoPlay:!0,loop:!0,style:{height:"60vh",width:"60vw"}}),r(b,{children:"No Withdrawals Found!"})]}),r(l,{spacing:3,children:d==null?void 0:d.map((e,i)=>{var t,s,j,k,D;return r(ye,{variants:ve,px:8,py:4,rounded:"lg",shadow:"lg",bg:le("white","gray.800"),maxW:"100%",children:r(l,{direction:"row",spacing:2,justifyContent:"space-evenly",children:o(l,{ml:2,w:"100%",direction:"row",spacing:4,alignItems:"center",justifyContent:"space-between",children:[o(l,{direction:"row",spacing:2,divider:r(ce,{}),children:[o(l,{spacing:1,children:[o(b,{size:"xs",color:"gray.700",children:["User: ",(t=e==null?void 0:e.user)==null?void 0:t.firstName," ",(s=e==null?void 0:e.user)==null?void 0:s.lastName]}),o(f,{size:"xs",color:"gray.700",children:["PAN: ",(k=(j=e==null?void 0:e.user)==null?void 0:j.pan)==null?void 0:k.id]})]}),r(b,{size:"md",alignSelf:"center",children:(D=e==null?void 0:e.fund)==null?void 0:D.name}),r(w,{size:"lg",colorScheme:"blue",children:de(e==null?void 0:e.amount)}),r(w,{size:"lg",colorScheme:"blue",children:ue(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),r(w,{size:"lg",colorScheme:"green",children:e==null?void 0:e.status}),e.status==="completed"&&o(w,{size:"lg",colorScheme:"gray",children:["UTR: ",e==null?void 0:e.utr]})]}),o(l,{direction:"row",spacing:1,children:[(e==null?void 0:e.status)==="approved"&&(n==null?void 0:n.isAdmin)&&o(l,{spacing:1,direction:"row",children:[r(T,{onChange:q=>U(q.target.value),placeholder:"Enter UTR",w:"150px",alignSelf:"center",size:"xs"}),r(h,{alignSelf:"center",onClick:()=>V(e==null?void 0:e._id),colorScheme:"red",size:"sm",variant:"solid",children:"Complete"})]}),(e==null?void 0:e.status)==="pending"&&(n==null?void 0:n.isAdmin)&&o(l,{direction:"row",spacing:1,children:[(n==null?void 0:n.isAdmin)&&r(h,{onClick:()=>H(e==null?void 0:e._id),colorScheme:"red",size:"sm",variant:"solid",children:"Reject"}),r(h,{onClick:()=>_(e==null?void 0:e._id),colorScheme:"green",size:"sm",variant:"solid",children:"Approve"})]})]})]})})},i+e._id)})})]}),r(z,{sx:{},children:(d==null?void 0:d.length)>0&&r(he,{defaultPageSize:S,defaultPage:C,total:500,paginationProps:{display:"flex",justifyContent:"center",marginTop:"2em"},pageNeighbours:1,showQuickJumper:!0,responsive:!0,onChange:e=>P(e),onShowSizeChange:(e,i)=>B(parseInt(i)),showSizeChanger:!0})})]})};export{We as default};
